<!DOCTYPE html>
<html>
    <head>
        <title>Command Module Generator for Skidbot Revolt</title>
        <link href="style.css" rel="stylesheet" type="text/css" />
    </head>
    <body>
        <main class="container" role="main">
            <h2>Command Module Generator for Skidbot Revolt</h2>
            <table class="table">
                <tr style="display: none;"">
                    <th>Has Help Content</th>
                    <td><input type="checkbox" id="hasHelpContent"></td>
                </tr>
                <tr>
                    <th>Internal Name</th>
                    <td><input type="text" id="internalName"></td>
                </tr>
                <tr>
                    <th>Help Category</th>
                    <td><input type="text" id="helpCategory"></td>
                </tr>
                <tr>
                    <th>Base Command Name</th>
                    <td><input type="text" id="baseCommandName"></td>
                </tr>
                <tr>
                    <th>Class Name</th>
                    <td><input type="text" id="className"></td>
                </tr>
                <tr>
                    <th>Wait for init</th>
                    <td><input type="checkbox" id="waitForInit" /></td>
                </tr>
                <tr>
                    <th>Permission Override</th>
                    <td>
                        <select id="permOverride">
                            <option value="null" selected>None</option>
                            <!-- <option value="ManageServer">Manage Server</option> -->
                        </select>
                    </td>
                </tr>
            </table>
            <a href="#" class="btn btn-primary" id="generate">Generate</a>
            <textarea style="min-height: min(20rem, 50vh);" id="output"></textarea>
        </main>
    </body>
    <script type="text/javascript">
        function generateOutput()
        {
            let hasHelpContent = document.getElementById("hasHelpContent").checked
            let internal = document.getElementById("internalName").value
            let category = document.getElementById("helpCategory").value
            let cmdName = document.getElementById("baseCommandName").value
            let className = document.getElementById("className").value
            let waitForInit = document.getElementById("waitForInit").checked;
            
            let catStr = category == null || category.length < 1 ? "null" : `"${category}"`;
            let intStr = internal == null || internal.length < 1 ? "null" : `"${internal}"`;
            let cmdStr = cmdName == null || cmdName.length < 1 ? "null" : `"${cmdName}"`;
            let wfiStr = waitForInit ? "true" : "false";

            let permStr = "null";
            var targetPermStrValue = document.getElementById("permOverride").options[document.getElementById("permOverride").selectedIndex].value;
            if (targetPermStrValue != null && targetPermStrValue != "null")
                permStr = `"${targetPermStrValue}"`;

            let content =
`[RevSharpModule]
public class ${className} : BaseModule
{
    public override async Task CommandReceived(CommandInfo info, Message message)
    {
        
    }

    public override bool HasHelpContent => ${hasHelpContent};
    public override string? InternalName => ${intStr};
    public override string? HelpCategory => ${catStr};
    public override string? BaseCommandName => ${cmdStr};
    public override bool WaitForInit => ${wfiStr};
    public override PermissionFlag? RequireServerPermission => ${permStr};
}`
            console.log(content)
            document.getElementById("output").innerHTML = content
        }
        document.getElementById("generate").addEventListener('click', () => {
            generateOutput()
        })
    </script>
</html>